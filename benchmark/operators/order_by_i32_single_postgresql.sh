#!/bin/bash

# Define path to PostgreSQL CLI
POSTGRESQL=psql

{ ${POSTGRESQL} -U postgres | grep 'Time' | cut -d ' ' -f 2; } << EOF
DROP DATABASE IF EXISTS benchmark_tmp;
CREATE DATABASE benchmark_tmp;
\c benchmark_tmp
CREATE TABLE Distinct_i32 ( id INT, n1 INT, n10 INT, n100 INT, n1000 INT, n10000 INT, n100000 INT);
\copy Distinct_i32 FROM 'benchmark/operators/data/Distinct_i32.csv' WITH DELIMITER ',' CSV HEADER;
\timing on
SELECT id FROM Distinct_i32 WHERE n100000 < -2147483647 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 < -1717986918 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 < -1288490188 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <  -858993459 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <  -429496729 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <           0 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <   429496729 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <   858993459 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <  1288490188 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <  1717986918 ORDER BY n100000;
SELECT id FROM Distinct_i32 WHERE n100000 <  2147483647 ORDER BY n100000;
EOF
